{"pageProps":{"entry":{"entry":"migrate-to-conoha","title":"comame.xyz を ConoHa に移した","date":"2019-07-11","tags":["server"],"type":"html"},"text":"<p>このはちゃんかわいい</p>\n\n\n<h2>Docker</h2>\n\n<p>今回は、Web サーバを Docker でコンテナに包んでみました。デプロイが圧倒的に簡単になりました。今まではマネージドサービスと自分でサーバを管理するのとの間で振り子のように動いていましたが、これからは移動も楽になる気がします。</p>\n\n\n<h2>速度</h2>\n\n<p>今までは Firebase Hosting の US リージョンに置いていたため、RTT が 300 ms くらいありました。流石に堪えられないなーと思っていたのが ConoHa に移した大きな理由の一つです。ConoHa は東京にリージョンがあるので、とてもはやいです (小並感)。</p>\n\n\n<h2>開発のしやすさ</h2>\n\n<p>今回は Nginx もコンテナに閉じ込めたので、リモートマシンでも完全に同じ環境でサーバを起動できるようになりました。これにより、今まではサーバにアップロードしないと確認できなかったようなこと (Secure Context で動く API とか) もローカル環境で手軽にできるようになりました。</p>\n\n<h2>改善したい点</h2>\n\n<ul>\n  <li>ログ設定をきちんとしていないので、コンテナを止めるとログも消えてしまう</li>\n  <li>Nginx の proxy_pass でサービス名を直に指定しているので、すべてのコンテナを立ち上げないとエラーを吐いてしまう</li>\n</ul>\n\n\n<h2></h2>\n<p>このはちゃんかわいい</p>\n"},"__N_SSG":true}